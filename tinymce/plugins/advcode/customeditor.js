/* Ephox advanced code plugin
 *
 * Copyright 2010-2016 Ephox Corporation.  All rights reserved.
 *
 * Version: 2.1.0-135
 */

!function(){"use strict";var t,n,r,e={},o={exports:e};n=e,r=o,t=void 0,function(e){"object"==typeof n&&void 0!==r?r.exports=e():"function"==typeof t&&t.amd?t([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=e()}(function(){return function i(u,c,l){function f(t,e){if(!c[t]){if(!u[t]){var n=!1;if(!e&&n)return n(t,!0);if(a)return a(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var o=c[t]={exports:{}};u[t][0].call(o.exports,function(e){return f(u[t][1][e]||e)},o,o.exports,i,u,c,l)}return c[t].exports}for(var a=!1,e=0;e<l.length;e++)f(l[e]);return f}({1:[function(e,t,n){var r,o,i=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function l(t){if(r===setTimeout)return setTimeout(t,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(e){r=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(e){o=c}}();var f,a=[],s=!1,d=-1;function p(){s&&f&&(s=!1,f.length?a=f.concat(a):d=-1,a.length&&m())}function m(){if(!s){var e=l(p);s=!0;for(var t=a.length;t;){for(f=a,a=[];++d<t;)f&&f[d].run();d=-1,t=a.length}f=null,s=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new h(e,t)),1!==a.length||s||l(m)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(e,s,t){(function(n){!function(e){var t=setTimeout;function r(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],a(e,this)}function o(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn(function(){var e=1===n._state?r.onFulfilled:r.onRejected;if(null!==e){var t;try{t=e(n._value)}catch(e){return void c(r.promise,e)}u(r.promise,t)}else(1===n._state?u:c)(r.promise,n._value)})):n._deferreds.push(r)}function u(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void l(t);if("function"==typeof n)return void a((r=n,o=e,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=e,l(t)}catch(e){c(t,e)}var r,o}function c(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)o(e,e._deferreds[t]);e._deferreds=null}function f(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function a(e,t){var n=!1;try{e(function(e){n||(n=!0,u(t,e))},function(e){n||(n=!0,c(t,e))})}catch(e){if(n)return;n=!0,c(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(r);return o(this,new f(e,t,n)),n},i.all=function(e){var c=Array.prototype.slice.call(e);return new i(function(r,o){if(0===c.length)return r([]);var i=c.length;function u(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){u(t,e)},o)}c[t]=e,0==--i&&r(c)}catch(e){o(e)}}for(var e=0;e<c.length;e++)u(e,c[e])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(n){return new i(function(e,t){t(n)})},i.race=function(o){return new i(function(e,t){for(var n=0,r=o.length;n<r;n++)o[n].then(e,t)})},i._immediateFn="function"==typeof n?function(e){n(e)}:function(e){t(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},void 0!==s&&s.exports?s.exports=i:e.Promise||(e.Promise=i)}(this)}).call(this,e("timers").setImmediate)},{timers:3}],3:[function(l,e,f){(function(e,t){var r=l("process/browser.js").nextTick,n=Function.prototype.apply,o=Array.prototype.slice,i={},u=0;function c(e,t){this._id=e,this._clearFn=t}f.setTimeout=function(){return new c(n.call(setTimeout,window,arguments),clearTimeout)},f.setInterval=function(){return new c(n.call(setInterval,window,arguments),clearInterval)},f.clearTimeout=f.clearInterval=function(e){e.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},f.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},f.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},f._unrefActive=f.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},f.setImmediate="function"==typeof e?e:function(e){var t=u++,n=!(arguments.length<2)&&o.call(arguments,1);return i[t]=!0,r(function(){i[t]&&(n?e.apply(null,n):e.call(null),f.clearImmediate(t))}),t},f.clearImmediate="function"==typeof t?t:function(e){delete i[e]}}).call(this,l("timers").setImmediate,l("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(e,t,n){var r=e("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});var l=o.exports.boltExport;var i=function(){var n={},c={};tinymce.Resource={add:function(e,t){c[e]&&(c[e](t),delete c[e]),n[e]=l.resolve(t)},load:function(r,o){var i='Script at URL "'+o+'" failed to load',u='Script at URL "'+o+"\" did not call `tinymce.Resource.add('"+r+"', data)` within 1 second";if(void 0!==n[r])return n[r];var e=new l(function(e,t){var n=function(e,t,n){void 0===n&&(n=1e3);var r=!1,o=null,i=function(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r||(r=!0,null!==o&&(clearTimeout(o),o=null),n.apply(null,e))}},u=i(e),c=i(t);return{reject:c,resolve:u,start:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r||(o=setTimeout(function(){return c.apply(null,e)},n))}}}(e,t);c[r]=n.resolve,tinymce.ScriptLoader.loadScripts([o],function(){return n.start(u)},function(){return n.reject(i)})});return n[r]=e}}},u=function(e,t){return tinymce.Resource||i(),tinymce.Resource.load(e,t)},c=function(n,r){return new l(function(e,t){(r||tinymce.DOM.styleSheetLoader).load(n,e,t)})},f=function(e,t,n,r){void 0===r&&(r="");var o,i,u=(o=e,{completeAfter:i=function(e,t){return t&&!t()||setTimeout(function(){e.state.completionActive||e.showHint({completeSingle:!1})},100),o.Pass},completeIfAfterLt:function(t){return i(t,function(){var e=t.getCursor();return"<"===t.getRange(o.Pos(e.line,e.ch-1),e)})},completeIfInTag:function(t){return i(t,function(){var e=t.getTokenAt(t.getCursor());return!!("string"!==e.type||/['"]/.test(e.string.charAt(e.string.length-1))&&1!==e.string.length)&&o.innerMode(t.getMode(),e.state).state.tagName})}}),c={lineWrapping:n.lineWrapping,lineNumbers:n.lineNumbers,foldGutter:n.foldGutter,theme:n.theme,direction:n.direction,matchTags:{bothTags:!0},keyMap:"sublime",gutters:n.gutter?["CodeMirror-linenumbers","CodeMirror-foldgutter"]:[],extraKeys:{"Alt-F":"findPersistent","Ctrl-J":"toMatchingTag","Ctrl-B":"selectNextOccurrence","'<'":u.completeAfter,"'/'":u.completeIfAfterLt,"' '":u.completeIfInTag,"'='":u.completeIfInTag,"Ctrl-Q":function(e){e.foldCode(e.getCursor())}},mode:"text/html",value:r},l=e(t,c),f=function(e){27!==e.keyCode&&e.stopPropagation()};t.addEventListener("keyup",f),t.addEventListener("keydown",f),t.addEventListener("keypress",f);return setTimeout(function(){l&&(l.refresh(),l.focus())},200),{cmi:l,unbind:function(){t.removeEventListener("keyup",f),t.removeEventListener("keydown",f),t.removeEventListener("keypress",f)}}},a=function(o,i){return new l(function(e){var t,n;o.style.width="100%",o.parentElement.classList.add("mce-codemirror"),e((t=i.codeMirrorScriptUrl,n=i.codeMirrorCssUrl,l.all([c(n),u("tinymce.plugins.advcode.CodeMirror",t)]).then(function(e){return e[0],(0,e[1])()})).then(function(e){var t=f(e,o,i),n=t.cmi,r=t.unbind;return{getValue:function(){return n.doc.getValue()},setValue:function(e){return n.doc.setValue(e)},destroy:function(){return r()}}}))})};tinymce.Resource.add("tinymce.plugins.advcode.customeditor",a)}();